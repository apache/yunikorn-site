"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[89732],{88205:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var t=o(13274),r=o(1780);const s={id:"run_tf",title:"Run TensorFlow Jobs",description:"How to run TensorFlow jobs with YuniKorn",keywords:["tensorflow"]},i=void 0,a={id:"user_guide/workloads/run_tf",title:"Run TensorFlow Jobs",description:"How to run TensorFlow jobs with YuniKorn",source:"@site/versioned_docs/version-0.12.1/user_guide/workloads/run_tensorflow.md",sourceDirName:"user_guide/workloads",slug:"/user_guide/workloads/run_tf",permalink:"/docs/0.12.1/user_guide/workloads/run_tf",draft:!1,unlisted:!1,tags:[],version:"0.12.1",frontMatter:{id:"run_tf",title:"Run TensorFlow Jobs",description:"How to run TensorFlow jobs with YuniKorn",keywords:["tensorflow"]},sidebar:"docs",previous:{title:"Run Flink Jobs",permalink:"/docs/0.12.1/user_guide/workloads/run_flink"},next:{title:"Cluster",permalink:"/docs/0.12.1/api/cluster"}},l={},c=[{value:"Install training-operator",id:"install-training-operator",level:2},{value:"Prepare the docker image",id:"prepare-the-docker-image",level:2},{value:"Run a TensorFlow job",id:"run-a-tensorflow-job",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["This guide gives an overview of how to set up ",(0,t.jsx)(n.a,{href:"https://github.com/kubeflow/training-operator",children:"training-operator"}),"\nand how to run a Tensorflow job with YuniKorn scheduler. The training-operator is a unified training operator maintained by\nKubeflow. It not only supports TensorFlow but also PyTorch, XGboots, etc."]}),"\n",(0,t.jsx)(n.h2,{id:"install-training-operator",children:"Install training-operator"}),"\n",(0,t.jsxs)(n.p,{children:["You can use the following command to install training operator in kubeflow namespace by default. If you have problems with installation,\nplease refer to ",(0,t.jsx)(n.a,{href:"https://github.com/kubeflow/training-operator#installation",children:"this doc"})," for details."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'kubectl apply -k "github.com/kubeflow/training-operator/manifests/overlays/standalone?ref=v1.3.0"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"prepare-the-docker-image",children:"Prepare the docker image"}),"\n",(0,t.jsx)(n.p,{children:"Before you start running a TensorFlow job on Kubernetes, you'll need to build the docker image."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Download files from ",(0,t.jsx)(n.a,{href:"https://github.com/apache/incubator-yunikorn-k8shim/tree/master/deployments/examples/tfjob",children:"deployment/examples/tfjob"})]}),"\n",(0,t.jsx)(n.li,{children:"To build this docker image with the following command"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"docker build -f Dockerfile -t kubeflow/tf-dist-mnist-test:1.0 .\n"})}),"\n",(0,t.jsx)(n.h2,{id:"run-a-tensorflow-job",children:"Run a TensorFlow job"}),"\n",(0,t.jsxs)(n.p,{children:["Here is a TFJob yaml for MNIST ",(0,t.jsx)(n.a,{href:"https://github.com/apache/incubator-yunikorn-k8shim/blob/master/deployments/examples/tfjob/tf-job-mnist.yaml",children:"example"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kubeflow.org/v1\nkind: TFJob\nmetadata:\n  name: dist-mnist-for-e2e-test\n  namespace: kubeflow\nspec:\n  tfReplicaSpecs:\n    PS:\n      replicas: 2\n      restartPolicy: Never\n      template:\n        metadata:\n          labels:\n            applicationId: "tf_job_20200521_001"\n            queue: root.sandbox\n        spec:\n          schedulerName: yunikorn\n          containers:\n            - name: tensorflow\n              image: kubeflow/tf-dist-mnist-test:1.0\n    Worker:\n      replicas: 4\n      restartPolicy: Never\n      template:\n        metadata:\n          labels:\n            applicationId: "tf_job_20200521_001"\n            queue: root.sandbox\n        spec:\n          schedulerName: yunikorn\n          containers:\n            - name: tensorflow\n              image: kubeflow/tf-dist-mnist-test:1.0\n'})}),"\n",(0,t.jsx)(n.p,{children:"Create the TFJob"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"kubectl create -f deployments/examples/tfjob/tf-job-mnist.yaml\n"})}),"\n",(0,t.jsxs)(n.p,{children:["You can view the job info from YuniKorn UI. If you do not know how to access the YuniKorn UI,\nplease read the document ",(0,t.jsx)(n.a,{href:"/docs/0.12.1/#access-the-web-ui",children:"here"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"tf-job-on-ui",src:o(10418).A+"",width:"2442",height:"1308"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},10418:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/tf-job-on-ui-e31edb85612822915f336b8cf9a25c3f.png"},1780:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>a});var t=o(79474);const r={},s=t.createContext(r);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);