"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[38600],{10233:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>u,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"api/cluster","title":"Cluster","description":"\x3c!--","source":"@site/versioned_docs/version-1.7.0/api/cluster.md","sourceDirName":"api","slug":"/api/cluster","permalink":"/docs/api/cluster","draft":false,"unlisted":false,"tags":[],"version":"1.7.0","frontMatter":{"id":"cluster","title":"Cluster"},"sidebar":"docs","previous":{"title":"Queue","permalink":"/docs/metrics/queue"},"next":{"title":"Scheduler","permalink":"/docs/api/scheduler"}}');var o=s(13274),i=s(76245);const c={id:"cluster",title:"Cluster"},l=void 0,t={},a=[{value:"Clusters",id:"clusters",level:2},{value:"Success response",id:"success-response",level:3},{value:"Error response",id:"error-response",level:3},{value:"Metrics",id:"metrics",level:2},{value:"Success response",id:"success-response-1",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Success response",id:"success-response-2",level:3},{value:"Configuration validation",id:"configuration-validation",level:2},{value:"Success response",id:"success-response-3",level:3},{value:"Allowed configuration",id:"allowed-configuration",level:4},{value:"Disallowed configuration",id:"disallowed-configuration",level:4}];function d(e){const n={code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"clusters",children:"Clusters"}),"\n",(0,o.jsx)(n.p,{children:"Returns general information about the clusters managed by the YuniKorn Scheduler.\nThe response includes build information about resource managers."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"URL"})," : ",(0,o.jsx)(n.code,{children:"/ws/v1/clusters"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Method"})," : ",(0,o.jsx)(n.code,{children:"GET"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Auth required"})," : NO"]}),"\n",(0,o.jsx)(n.h3,{id:"success-response",children:"Success response"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Code"})," : ",(0,o.jsx)(n.code,{children:"200 OK"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Content examples"})}),"\n",(0,o.jsx)(n.p,{children:"As an example, here is a response from a cluster with 1 resource manager."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "startTime": 1697100824863892713,\n        "rmBuildInformation": [\n            {\n                "arch": "amd64",\n                "buildDate": "2023-09-04T18:11:43+0800",\n                "buildVersion": "latest",\n                "coreSHA": "0ecf24d2aad2",\n                "goVersion": "1.21",\n                "isPluginVersion": "false",\n                "rmId": "mycluster",\n                "shimSHA": "8b26c373b4b5",\n                "siSHA": "e7622cf54e95"\n            }\n        ],\n        "partition": "default",\n        "clusterName": "kubernetes"\n    }\n]\n'})}),"\n",(0,o.jsx)(n.h3,{id:"error-response",children:"Error response"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Code"})," : ",(0,o.jsx)(n.code,{children:"500 Internal Server Error"})]}),"\n",(0,o.jsx)(n.h2,{id:"metrics",children:"Metrics"}),"\n",(0,o.jsx)(n.p,{children:"Endpoint to retrieve metrics from the Prometheus server.\nThe metrics are dumped with help messages and type information."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"URL"})," : ",(0,o.jsx)(n.code,{children:"/ws/v1/metrics"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Method"})," : ",(0,o.jsx)(n.code,{children:"GET"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Auth required"})," : NO"]}),"\n",(0,o.jsx)(n.h3,{id:"success-response-1",children:"Success response"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Code"})," : ",(0,o.jsx)(n.code,{children:"200 OK"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Content examples"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:'# HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.\n# TYPE go_gc_duration_seconds summary\ngo_gc_duration_seconds{quantile="0"} 2.567e-05\ngo_gc_duration_seconds{quantile="0.25"} 3.5727e-05\ngo_gc_duration_seconds{quantile="0.5"} 4.5144e-05\ngo_gc_duration_seconds{quantile="0.75"} 6.0024e-05\ngo_gc_duration_seconds{quantile="1"} 0.00022528\ngo_gc_duration_seconds_sum 0.021561648\ngo_gc_duration_seconds_count 436\n# HELP go_goroutines Number of goroutines that currently exist.\n# TYPE go_goroutines gauge\ngo_goroutines 82\n# HELP go_info Information about the Go environment.\n# TYPE go_info gauge\ngo_info{version="go1.12.17"} 1\n# HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.\n# TYPE go_memstats_alloc_bytes gauge\ngo_memstats_alloc_bytes 9.6866248e+07\n\n...\n\n# HELP yunikorn_scheduler_vcore_nodes_usage Nodes resource usage, by resource name.\n# TYPE yunikorn_scheduler_vcore_nodes_usage gauge\nyunikorn_scheduler_vcore_nodes_usage{range="(10%, 20%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="(20%,30%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="(30%,40%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="(40%,50%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="(50%,60%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="(60%,70%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="(70%,80%]"} 1\nyunikorn_scheduler_vcore_nodes_usage{range="(80%,90%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="(90%,100%]"} 0\nyunikorn_scheduler_vcore_nodes_usage{range="[0,10%]"} 0\n'})}),"\n",(0,o.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(n.p,{children:"Endpoint to retrieve the current scheduler configuration"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"URL"})," : ",(0,o.jsx)(n.code,{children:"/ws/v1/config"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Method"})," : ",(0,o.jsx)(n.code,{children:"GET"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Auth required"})," : NO"]}),"\n",(0,o.jsx)(n.h3,{id:"success-response-2",children:"Success response"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Code"})," : ",(0,o.jsx)(n.code,{children:"200 OK"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.strong,{children:["Content example (with ",(0,o.jsx)(n.code,{children:"Accept: application/json"})," header)"]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n    "Partitions": [\n        {\n            "Name": "default",\n            "Queues": [\n                {\n                    "Name": "root",\n                    "Parent": true,\n                    "Resources": {},\n                    "SubmitACL": "*",\n                    "ChildTemplate": {\n                        "Resources": {}\n                    }\n                }\n            ],\n            "PlacementRules": [\n                {\n                    "Name": "tag",\n                    "Create": true,\n                    "Filter": {\n                        "Type": ""\n                    },\n                    "Value": "namespace"\n                }\n            ],\n            "Preemption": {\n                "Enabled": false\n            },\n            "NodeSortPolicy": {\n                "Type": ""\n            }\n        }\n    ],\n    "Checksum": "FD5D3726DF0F02416E02F3919D78F61B15D14425A34142D93B24C137ED056946",\n    "Extra": {\n        "event.trackingEnabled": "false",\n        "log.core.scheduler.level": "info",\n        "log.core.security.level": "info",\n        "log.level": "debug"\n    }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.strong,{children:["Content example (without ",(0,o.jsx)(n.code,{children:"Accept: application/json"})," header)"]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'partitions:\n    - name: default\n      queues:\n          - name: root\n            parent: true\n            submitacl: "*"\n      placementrules:\n          - name: tag\n            create: true\n            value: namespace\nchecksum: FD5D3726DF0F02416E02F3919D78F61B15D14425A34142D93B24C137ED056946\nextra:\n    event.trackingEnabled: "false"\n    log.core.scheduler.level: info\n    log.core.security.level: info\n    log.level: debug\n\n'})}),"\n",(0,o.jsx)(n.h2,{id:"configuration-validation",children:"Configuration validation"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"URL"})," : ",(0,o.jsx)(n.code,{children:"/ws/v1/validate-conf"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Method"})," : ",(0,o.jsx)(n.code,{children:"POST"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Auth required"})," : NO"]}),"\n",(0,o.jsx)(n.h3,{id:"success-response-3",children:"Success response"}),"\n",(0,o.jsx)(n.p,{children:"Regardless whether the configuration is allowed or not if the server was able to process the request, it will yield a 200 HTTP status code."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Code"})," : ",(0,o.jsx)(n.code,{children:"200 OK"})]}),"\n",(0,o.jsx)(n.h4,{id:"allowed-configuration",children:"Allowed configuration"}),"\n",(0,o.jsx)(n.p,{children:"Sending the following simple configuration yields an accept"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"partitions:\n  - name: default\n    queues:\n      - name: root\n        queues:\n          - name: test\n"})}),"\n",(0,o.jsx)(n.p,{children:"Reponse"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n    "allowed": true,\n    "reason": ""\n}\n'})}),"\n",(0,o.jsx)(n.h4,{id:"disallowed-configuration",children:"Disallowed configuration"}),"\n",(0,o.jsx)(n.p,{children:'The following configuration is not allowed due to the "wrong_text" field put into the yaml file.'}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"partitions:\n  - name: default\n    queues:\n      - name: root\n        queues:\n          - name: test\n  - wrong_text\n"})}),"\n",(0,o.jsx)(n.p,{children:"Reponse"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n    "allowed": false,\n    "reason": "yaml: unmarshal errors:\\n  line 7: cannot unmarshal !!str `wrong_text` into configs.PartitionConfig"\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},76245:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var r=s(79474);const o={},i=r.createContext(o);function c(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);