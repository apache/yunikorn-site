"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[26155],{87411:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"user_guide/usergroup_resolution","title":"User & Group Resolution","description":"\x3c!--","source":"@site/versioned_docs/version-1.0.0/user_guide/usergroup_resolution.md","sourceDirName":"user_guide","slug":"/user_guide/usergroup_resolution","permalink":"/docs/1.0.0/user_guide/usergroup_resolution","draft":false,"unlisted":false,"tags":[],"version":"1.0.0","frontMatter":{"id":"usergroup_resolution","title":"User & Group Resolution"},"sidebar":"docs","previous":{"title":"App Placement Rules","permalink":"/docs/1.0.0/user_guide/placement_rules"},"next":{"title":"Sorting Policies","permalink":"/docs/1.0.0/user_guide/sorting_policies"}}');var r=t(47259),i=t(89796);const o={id:"usergroup_resolution",title:"User & Group Resolution"},a=void 0,l={},d=[{value:"User resolution",id:"user-resolution",level:2},{value:"Group resolution",id:"group-resolution",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"user-resolution",children:"User resolution"}),"\n",(0,r.jsxs)(n.p,{children:["User information is an important aspect of the scheduling cycle. It is one of the key identifier that can be used to determine the queue to which a job should be submitted. The Yunikorn Scheduler relies on the K8s Shim to provide user information. In the world of Kubernetes, there is no object defined that identfies the actual user. This is by design and more information can be found ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/authentication/#users-in-kubernetes",children:"here"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Since, Kubernetes has no pre-defined field or resource for user information and individual cluster deployments with unique user identification tools can vary, we have defined a standard way of identifying the user. Yunikorn requires a Kubernetes ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/",children:"Label"})," added. Using the ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/",children:"recommendation"})," provided here, the default label is defined as below:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Label"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"yunikorn.apache.org/username"}),(0,r.jsxs)(n.td,{children:["User name. It can have duplicate entries but only the first value will be used. The default user is ",(0,r.jsx)(n.code,{children:"nobody"})]})]})})]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'metadata:\n  labels:\n    yunikorn.apache.org/username: "john"\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsx)(n.p,{children:"In order to make this field uniquiely identifiable to the authorized user, the suggestion is to add this label as an immutable field by the user identification tool used by the cluster administrators. The cluster administrators or users are free to use any method or tool to add this field and value. This includes adding it manually at the time of submission."})]}),"\n",(0,r.jsx)(n.admonition,{title:"Assumption",type:"note",children:(0,r.jsx)(n.p,{children:"Assumption:\nYunikorn assumes that all pods belonging to an application are owned by the same user. We recommend that the user label is added to every pod of an app. This is to ensure that there is no discrepency."})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"yunikorn.apache.org/username"})," key can be customized by overriding the default value using the ",(0,r.jsx)(n.code,{children:"USER_LABEL_KEY"}),"env variable in the ",(0,r.jsx)(n.a,{href:"https://github.com/apache/yunikorn-release/blob/master/helm-charts/yunikorn/templates/deployment.yaml",children:"K8s Deployment"}),". This is particularly useful in scenarios where the user label is already being added or if the label has to be modified for some secuirty reasons."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'            env:\n            - name: USER_LABEL_KEY\n              value: "custom_user_label"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"group-resolution",children:"Group resolution"}),"\n",(0,r.jsx)(n.p,{children:"Group membership resolution is pluggables and is defined here. Groups do not have to be part of provided user and group object. When the object is added to the cache the groups are automatically resolved based on the resolution that is configured.\nThe resolver which is linked to the cache can be set per partition."}),"\n",(0,r.jsx)(n.p,{children:'The default group resolver is "no resolver".\nThis resolver just echos the user name and a primary group with the same name as the user.'}),"\n",(0,r.jsx)(n.p,{children:"Other resolvers are:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OS resolver"}),"\n",(0,r.jsx)(n.li,{children:"test resolver"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},89796:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(96363);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);