<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-design/user_group_resource_usage_enforcement" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">User Based Quota Enforcement | Apache YuniKorn</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://yunikorn.apache.org/img/logo/yunikorn-logo-main.png"><meta data-rh="true" name="twitter:image" content="https://yunikorn.apache.org/img/logo/yunikorn-logo-main.png"><meta data-rh="true" property="og:url" content="https://yunikorn.apache.org/docs/next/design/user_group_resource_usage_enforcement"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="User Based Quota Enforcement | Apache YuniKorn"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/img/yunikorn.ico"><link data-rh="true" rel="canonical" href="https://yunikorn.apache.org/docs/next/design/user_group_resource_usage_enforcement"><link data-rh="true" rel="alternate" href="https://yunikorn.apache.org/docs/next/design/user_group_resource_usage_enforcement" hreflang="en"><link data-rh="true" rel="alternate" href="https://yunikorn.apache.org/docs/next/design/user_group_resource_usage_enforcement" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Q1V951BG2V-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Apache YuniKorn" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.57f4caef.css">
<script src="/assets/js/runtime~main.dd672f16.js" defer="defer"></script>
<script src="/assets/js/main.1ba8fec7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fIH8" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar__FTF" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_wDNR"></div><div class="content_DgxC announcementBarContent_HmXy">1.5.1 has been released, check the <a href="/community/download">DOWNLOADS</a>.</div><button type="button" aria-label="Close" class="clean-btn close closeButton_KmNL announcementBarClose_BG67"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo/yunikorn_blue_logo.png" alt="YuniKorn Site Logo" class="themedComponent_yzub themedComponent--light_pOwb"><img src="/img/logo/yunikorn_white_logo.png" alt="YuniKorn Site Logo" class="themedComponent_yzub themedComponent--dark_xdnF"></div><b class="navbar__title text--truncate">Apache YuniKorn</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/community/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/community/download">Download</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/get_involved">Get Involved</a></li><li><a class="dropdown__link" href="/community/how_to_contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/community/coding_guidelines">Coding Guidelines</a></li><li><a class="dropdown__link" href="/community/reporting_issues">Reporting Issues</a></li><li><a class="dropdown__link" href="/community/release_procedure">Release Procedure</a></li><li><a class="dropdown__link" href="/community/events">Events</a></li><li><a class="dropdown__link" href="/community/people">People</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Apache Software Foundation<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsors<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy Policy<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/next/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/design/user_group_resource_usage_enforcement">Next</a></li><li><a class="dropdown__link" href="/docs/design/user_group_resource_usage_enforcement">1.5.1</a></li><li><a class="dropdown__link" href="/docs/1.5.0/design/user_group_resource_usage_enforcement">1.5.0</a></li><li><a class="dropdown__link" href="/docs/1.4.0/design/user_group_resource_usage_enforcement">1.4.0</a></li><li><a class="dropdown__link" href="/docs/1.3.0/design/user_group_resource_usage_enforcement">1.3.0</a></li><li><a class="dropdown__link" href="/docs/1.2.0/">1.2.0</a></li><li><a class="dropdown__link" href="/docs/1.1.0/">1.1.0</a></li><li><a class="dropdown__link" href="/docs/1.0.0/">1.0.0</a></li><li><a class="dropdown__link" href="/docs/0.12.2/">0.12.2</a></li><li><a class="dropdown__link" href="/docs/0.12.1/">0.12.1</a></li><li><a class="dropdown__link" href="/docs/0.11.0/">0.11.0</a></li><li><a class="dropdown__link" href="/docs/0.10.0/">0.10.0</a></li><li><a class="dropdown__link" href="/docs/0.9.0/">0.9.0</a></li><li><a class="dropdown__link" href="/docs/0.8.0/">0.8.0</a></li></ul></div><a href="https://github.com/apache/yunikorn-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_CXxL colorModeToggle_r3Ku"><button class="clean-btn toggleButton_A2Gq toggleButtonDisabled_MBgh" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_ZNXA"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon__KEK"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_eonw"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_txSM"><div class="docsWrapper_aujV"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_fDTy" type="button"></button><div class="docRoot_ITF8"><aside class="theme-doc-sidebar-container docSidebarContainer_coE9"><div class="sidebarViewport_XDus"><div class="sidebar_duME"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_d40_ menuWithAnnouncementBar_QXd6"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/next/">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/next/user_guide/deployment_modes">User Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/next/developer_guide/env_setup">Developer Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/developer_guide/env_setup">Dev Environment Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/developer_guide/build">Build and Run</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/developer_guide/dependencies">Go module updates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/developer_guide/deployment">Deploy to Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/developer_guide/openshift_development">Development in CodeReady Containers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/developer_guide/scheduler_object_states">Scheduler Object States</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/developer_guide/e2e_test">End-to-End Testing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/next/design/architecture">Designs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/scheduler_plugin">K8s Scheduler Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/gang_scheduling">Gang scheduling design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/user_group">User/Group handling and lookup design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/user_based_resource_usage_tracking">User Based Resource Usage Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/next/design/user_group_resource_usage_enforcement">User Based Quota Enforcement</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/historical_usage_tracking">Historical Usage Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/interface_message_simplification">Simplifying Interface Messages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/cache_removal">Scheduler cache removal design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/preemption">Preemption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/simple_preemptor">DaemonSet Scheduling using Simple Preemptor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/generic_resource">Generic Resource Types in Namespace Quota</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/priority_scheduling">Priority Scheduling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/resilience">Resilience</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/config_v2">Configuration V2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/design/scheduler_configuration">Scheduler Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/next/archived_design/k8shim">Archived Designs</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/next/performance/evaluate_perf_function_with_kubemark">Performance</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_fQ9A"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_L8rf"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Apache YuniKorn<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/design/user_group_resource_usage_enforcement">latest version</a></b> (<!-- -->1.5.1<!-- -->).</div></div><div class="docItemContainer_J6oa"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer__4Nk" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_lw5W"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Developer Guide</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Designs</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">User Based Quota Enforcement</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_hejs theme-doc-toc-mobile tocMobile_K3aG"><button type="button" class="clean-btn tocCollapsibleButton_a3TS">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>User Based Quota Enforcement</h1></header><h2 class="anchor anchorWithStickyNavbar_NlAN" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Enforcing resource allocation usage is currently limited to a queue.
As part of the allocation process for an application, which owns the allocation, triggers an update of the resource usage for users and groups.
The tracking for <a href="/docs/next/design/user_based_resource_usage_tracking">user resource usage tracking in YuniKorn</a> is described and implemented independently of the enforcement.</p>
<p>This design builds on top of the tracking design as referenced above. Like a queue a user/group could have a limit set.
A limit can specify a resource usage quota, and an application usage limit.
Enforcing the limit which connects the usage to the limit settings is covered in this design.</p>
<h2 class="anchor anchorWithStickyNavbar_NlAN" id="goals">Goals<a href="#goals" class="hash-link" aria-label="Direct link to Goals" title="Direct link to Goals">​</a></h2>
<ul>
<li>Implementation of the enforcement for user and group limits:<!-- -->
<ul>
<li>Resource usage quota</li>
<li>Running applications</li>
</ul>
</li>
<li>Configuration processing<!-- -->
<ul>
<li>Process limit object values from the queue configuration</li>
</ul>
</li>
<li>Updates to the tracking interface to support enforcement as part of increases:<!-- -->
<ul>
<li>Increase a user/group running applications</li>
<li>Increase a user/group resource usage</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_NlAN" id="non-goals">Non Goals<a href="#non-goals" class="hash-link" aria-label="Direct link to Non Goals" title="Direct link to Non Goals">​</a></h2>
<ul>
<li>User and group retrieval is part of the k8shim which is out of scope</li>
<li>Exposing usage as a metric into prometheus</li>
<li>Enforcement of queue quotas or running applications.</li>
<li>Tracking of users and or groups, see <a href="/docs/next/design/user_based_resource_usage_tracking">User and Group usage tracking design doc</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_NlAN" id="configuration-processing">Configuration processing<a href="#configuration-processing" class="hash-link" aria-label="Direct link to Configuration processing" title="Direct link to Configuration processing">​</a></h2>
<p>The queue configuration definition has a limit object defined as <a href="/docs/next/user_guide/queue_config#limits">per the documentation</a>.
User and group limits are based on those objects.
However the current configuration processing only performs a syntax check not a content check.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="generic-behaviour">Generic behaviour<a href="#generic-behaviour" class="hash-link" aria-label="Direct link to Generic behaviour" title="Direct link to Generic behaviour">​</a></h3>
<p>Limits can be configured for queues at any level. Limits are applied recursively in the case of a queue limit.
This means that a limit on the root queue is an overall limit in the cluster for the user or group.
A root queue limit is thus also equivalent with the partition limit. While if both the root queue limit and the partition limit exist and are not equal, an error will be returned.</p>
<p>A limit is per individual user or group. It is not a combined limit for all users or groups specified in the limit object.
See the below limit object as an example.
In this example both users sue and bob are allowed to run 2 applications and can each use 10 cpu and 250G of memory.
Users and or groups not defined are not affected by this limit object.</p>
<div class="language-yaml codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-yaml codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;example entry&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">maxapplications</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">maxresources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 250G</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">users</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> sue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> bob</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the case that limits are configured at multiple levels in the hierarchy a fixed order of enforcement is used.
Like with queue quotas, checks start at the leaf queue and work their way up the hierarchy finishing at the root level.
For the limit configuration processing the same needs to be implemented and the config should be rejected if it does not comply.
Any limit set at any level below the root must always be smaller or equal to the root limit.</p>
<p>The checks for the limit configuration must be part of the generic configuration checks currently performed as part of the loading of the configuration.
We cannot allow the configuration to be accepted at the queue level and later be denied at the limit level checks. A change is all or nothing, we cannot apply partial changes. Configuration checks must be made without impacting the scheduling cycles. After the change has passed the configuration check the changed configuration must then be applied in a single action.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="wildcard-interpretation">Wildcard interpretation<a href="#wildcard-interpretation" class="hash-link" aria-label="Direct link to Wildcard interpretation" title="Direct link to Wildcard interpretation">​</a></h3>
<p>Wildcard can only be used as the only entry in the limit object according to the documentation.
There can be multiple limit objects in the overall limits for a queue.
As part of this design the interpretation of the wildcard needs to be defined.
Wildcards interpretation is related to the ordering of the limit objects in the overall limits object.
The usage and interpretation will be different for users and groups.</p>
<p>In general terms: allowing a wildcard in the user or group list only as part of the last entry of the limits list.
After the wildcard has been added for either the user or group list we do not allow a user or group list with a non wildcard entry.
This is especially important for the group resolution. It does allow specifying a user and group wildcard with different limits set.
In all cases, there will only be a match using the wildcard if none of the earlier limit entries match.</p>
<h4 class="anchor anchorWithStickyNavbar_NlAN" id="user">User<a href="#user" class="hash-link" aria-label="Direct link to User" title="Direct link to User">​</a></h4>
<p>Users that are specified as part of a limit will be assigned that specific limit.
If a limit with a wildcard is specified all users that are not already assigned a limit will be assigned the wildcard limit.
For the user entry the wildcard sets a default quota for every user on that queue. Overridden by the named user entries.</p>
<p>Specifying a single limit for users using the wildcard is allowed. There is no requirement to have a wildcard entry.</p>
<h4 class="anchor anchorWithStickyNavbar_NlAN" id="group">Group<a href="#group" class="hash-link" aria-label="Direct link to Group" title="Direct link to Group">​</a></h4>
<p>For groups the interpretation is slightly more complex.
As explained as part of the tracking documentation the group that the usage is tracked against must match the membership of the user.
A wildcard group matches any group.</p>
<p>Specifying a wildcard for the group limit sets a cumulative limit for all users in that queue.
If there is no specific group mentioned the wildcard group limit would thus be the same as the queue limit.
For that reason we do not allow specifying only one group limit that is using the wildcard.
There must be at least one limit with a group name defined.</p>
<p>The combination of one or more named group limits with a wildcard group limit is allowed.
There is no requirement to have a wildcard entry.</p>
<p>The hierarchy is considered bottom up, starting from the leaf up to the root.
The first group that is specified in the queue hierarchy for limiting usage that matches a group in the <em>UserGroup</em> object is selected for that application.
That definition has an impact on the wildcard interpretation and the wildcard has an impact on the group selection.
The wildcard will indirectly affect group quotas set for a specific group higher up in the hierarchy.
This point needs clear documentation as part of the group selection algorithm and its side effects.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="example-configuration">Example configuration<a href="#example-configuration" class="hash-link" aria-label="Direct link to Example configuration" title="Direct link to Example configuration">​</a></h3>
<p>An example of a set of limits. A mixture of a user and multiple groups each with a limit.
Followed by the catch-all for both users and groups with separate resource limits.</p>
<p>In the example below all users, except the user “sue” have the same limit set. Members of the group “development” and the group “test” both have the same limit set. All other users who are not a member of the group “development” or “test” are counted towards the cumulative group limit.</p>
<div class="language-yaml codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-yaml codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;specific user&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">users</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sue&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">maxresources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 25G</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token key atrule">vcore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;specific groups&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">groups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;development&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;test&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">maxresources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 100G</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token key atrule">vcore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user catch all&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">users</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">maxresources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 10G</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token key atrule">vcore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">limit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;group catch all&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">groups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">maxresources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 50G</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token key atrule">vcore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="syntax-checking">Syntax checking<a href="#syntax-checking" class="hash-link" aria-label="Direct link to Syntax checking" title="Direct link to Syntax checking">​</a></h3>
<p>As part of the already existing queue configuration processing the syntax for the configuration is checked.
This check is triggered also for a reload of the file, via the config map, or the REST interface.
Rudimentary limit object checking is implemented as part of the config check.</p>
<p>The above described changes around the wildcards and what is allowed is not part of the configuration validation and must be added.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="quota-checks">Quota checks<a href="#quota-checks" class="hash-link" aria-label="Direct link to Quota checks" title="Direct link to Quota checks">​</a></h3>
<p>No checks are performed for the limits against the queue quotas.
This means that as part of the current checks a limit can be set that is higher than the queue would allow.
There is also no hierarchical check in place. This means that a child could set higher limits than is possible based on the parent settings.</p>
<p>The configuration validation processing must be extended to the limit objects.
At each level in the configuration the resource quota assigned in a limit must be smaller than the maximum allowed at that level for the queue.
The queue quota processing already has this builtin and the limit should be checked against the quota.</p>
<p>The hierarchical check for limits contains a further complexity.
A limit at one level might not apply to the same users or groups as the limit at the level below it.
An implementation decision will need to be made on how far we want to go with the checks.
Most, if not all, of the configurations that we do not want to allow do not break the system.
We will not be able to check user and group interactions as we do not know the group memberships.
The only thing we can check is the same user or group at different levels in the hierarchy.</p>
<h2 class="anchor anchorWithStickyNavbar_NlAN" id="configuration-updates-and-storage">Configuration updates and storage<a href="#configuration-updates-and-storage" class="hash-link" aria-label="Direct link to Configuration updates and storage" title="Direct link to Configuration updates and storage">​</a></h2>
<p>The configuration is read as part of the queue configuration.
The queue configuration when processed creates, deletes or updates queues from the queue structure as appropriate.
For limits linked to users or groups we could pre-generate the named entries but we cannot do that for wildcards.
To support wildcards we need to at least store the configuration inside the user group manager code.</p>
<p>The definition of the configuration store and the methods that need to be defined will be left as an implementation detail.
It must be internal to the user group manager and will be based on the existing configuration objects.</p>
<p>The configuration for the limits should be maintained as a separate hierarchy from the scheduling queues and the tracked users and groups.
This is required to allow parallel processing of changes and scheduling.
This becomes more important with an increased number of users, groups and or queues.</p>
<p>Proposal is to pass the full configuration after it has been accepted by the system to an independent update routine for updating the affected objects in the user group manager.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="processing-changes-existing-objects">Processing changes existing objects<a href="#processing-changes-existing-objects" class="hash-link" aria-label="Direct link to Processing changes existing objects" title="Direct link to Processing changes existing objects">​</a></h3>
<p>As configuration changes are based on queue changes a single queue change could trigger multiple tracker object changes.</p>
<p>Applying the change from the configuration to an existing object in the structure of the user group manager would be initiated from the queue configuration traversal.
All entries inside the limit are then processed.
A comparison between the existing and new values is required to allow the correct removal of a limit via the updated configuration.</p>
<p>If the user object does not exist the update will be a NOP, otherwise the user object will be updated by calling the setter method with the corresponding values.</p>
<p>Wildcards will trigger an update of all objects of the specific type, user or group, for the queue they are linked to.
These kinds of updates could be expensive which also warrants the case for comparison of the existing values.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="queue-tracking">Queue tracking<a href="#queue-tracking" class="hash-link" aria-label="Direct link to Queue tracking" title="Direct link to Queue tracking">​</a></h3>
<p>The queueTracker object is the location where the limits are actually stored. The user and group objects do not contain the settings.</p>
<p>The setter methods defined need to transparently handle the update.
There should be no difference in behaviour to an update of existing values or setting values that do not exist.
As an example: a leaf queue might have a value set for the maximum resources for the user.
The new configuration does not have a value set. The setter must clear the existing value.
Second example: a limit on a queue is not set for a group.
The new configuration does set a limit for the group.
This should not result in the queue(s) in the hierarchy to be created.
If the queue exists in the hierarchy it will be updated.</p>
<p>The following change is made to the queueTracker object.
New fields are added to store the limit for the applications and the resources.
New methods are added to allow updating these new values from a configuration change.</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type queueTracker struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	queueName           string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	resourceUsage       *Resource</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	runningApplications map[string]boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	maxResourceUsage    *Resource</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	maxRunningApps      unit64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	childQueues   map[string]*queueTracker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(qt *queueTracker) setMaxApplications(count uint64, queuePath string)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(qt *queueTracker) setMaxResources(resource *Resource, queuePath string)</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An empty queue path indicates that the change needs to be applied to the current queue object. The queuePath is a fully qualified queue path that starts with “root’.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="user-tracking">User tracking<a href="#user-tracking" class="hash-link" aria-label="Direct link to User tracking" title="Direct link to User tracking">​</a></h3>
<p>The following change is made to the userTracker object. New methods to allow updating the new limit values stored in the queue objects.</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(ut *userTracker) setMaxApplications(count uint64, queuePath string)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(ut *userTracker) setMaxResources(resource *Resource, queuePath string)</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="group-tracking">Group tracking<a href="#group-tracking" class="hash-link" aria-label="Direct link to Group tracking" title="Direct link to Group tracking">​</a></h3>
<p>The following change is made to the groupTracker object. New methods to allow updating the new limit values stored in the queue objects.</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(ut *groupTracker) setMaxApplications(count uint64, queuePath string)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(ut *groupTracker) setMaxResources(resource *Resource, queuePath string)</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_NlAN" id="new-queue-to-track">New queue to track<a href="#new-queue-to-track" class="hash-link" aria-label="Direct link to New queue to track" title="Direct link to New queue to track">​</a></h2>
<p>As part of the usage tracking new objects are created for the users and or groups that are tracked.
For users there is a change required to make sure the correct limits are set.
This happens at two points while processing users.
First is during the creation of a new user tracker object.
Second is while increasing the usage of a queue which does not exist yet in the hierarchy.</p>
<p>The logic to retrieve the configuration should be built into the creation of the queueTracker objects.
The objects are not pre-created. They are only created as part of the <em>increaseResource</em> call.
The current call does not allow passing in the identity that the queue object is tracking for.
That detail is stored in the container object: the userTracker or groupTracker object.</p>
<p>To allow the automatic creation of the queueTracker objects the identity will need to be passed into the increaseResource call of the queueTracker object.
The identity and type are required to find the configuration setting and apply the proper limits during the creation of the queueTracker object.</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type trackingType int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">const (</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    none trackingType = iota</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(qt *queueTracker) increaseResource(queuePath, applicationID, identity string, type trackingType, usage *Resource)</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <em>trackingType</em> specifies one of the two types we can track. An iota is preferred above the usage of a plain integer or boolean (user true or false) kind of setup.</p>
<h2 class="anchor anchorWithStickyNavbar_NlAN" id="enforcement-changes">Enforcement changes<a href="#enforcement-changes" class="hash-link" aria-label="Direct link to Enforcement changes" title="Direct link to Enforcement changes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="tracker-interface-update">Tracker interface update<a href="#tracker-interface-update" class="hash-link" aria-label="Direct link to Tracker interface update" title="Direct link to Tracker interface update">​</a></h3>
<p>The current tracker does not support denying a change. For enforcement of quotas on the usage there has to be a possibility to deny a change.
This denial can only occur on an increase of tracked resources. A decrease of the usage, i.e. a removal of an allocation because a pod has finished, can never be denied.</p>
<p>This limits the change to support quota enforcement to a single change in the Tracker interface.
The <em>IncreaseTrackedResource</em> call returns the state of the increase requested.
The return value can either be true or false. The call must only return true if the increase is allowed for both the user and the group tracked for the request.
If either of the userTracker or groupTracker quota would be exceeded no change is made to either object and false is returned.</p>
<p>The following change is made to the Tracker interface:</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type Tracker interface {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    IncreaseTrackedResource(queuePath, applicationID string, usage *Resource, user *security.UserGroup) bool</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    DecreaseTrackedResource(queuePath, applicationID string, usage *Resource, removeApp bool, user *security.UserGroup)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The change must be applied to both userTracker and groupTracker.
Until the change is applied to both the userTracker and groupTracker, no other updates are allowed of either object.
The increase and decrease processing must still follow the same order. Both must update the userTracker and related groupTracker objects in the same order.
This was a requirement described in the tracking design and that has not changed.</p>
<p>If the call to <em>IncreaseTrackedResource</em> returns false the allocation that triggered the change needs to be abandoned.
Any change that was made to objects inside the scheduler, like an application, queue or node, must be reversed.
The scheduling cycle proceeds as if no allocation was made.</p>
<p>The error return value for both the <em>IncreaseTrackedResource</em> and the <em>DecreaseTrackedResource</em> have been removed.
The reason is that there is nothing that could be done by the caller to change the outcome or fail any changes if an error was returned.
Both functions should still log the error case as it could point to a bug in the code.
A caller should never have to pass in empty or nil parameters.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="user-tracking-1">User tracking<a href="#user-tracking-1" class="hash-link" aria-label="Direct link to User tracking" title="Direct link to User tracking">​</a></h3>
<p>The following change is made to the userTracker method. There is no change to the structure itself for the enforcement checks:</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(ut *userTracker) increaseResource(queuePath, applicationID string, alloc *Resource) bool</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="group-tracking-1">Group tracking<a href="#group-tracking-1" class="hash-link" aria-label="Direct link to Group tracking" title="Direct link to Group tracking">​</a></h3>
<p>The following change is made to the groupTracker method. There is no change to the structure itself for the enforcement checks:</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(gt *groupTracker) increaseResource(queuePath, applicationID string, alloc *Resource) bool</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="queue-tracking-1">Queue tracking<a href="#queue-tracking-1" class="hash-link" aria-label="Direct link to Queue tracking" title="Direct link to Queue tracking">​</a></h3>
<p>The following change is made to the queueTracker method. There is no change to the structure itself for the enforcement checks:</p>
<div class="codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-text codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package user_group_manager</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(qt *queueTracker) increaseResource(queuePath, applicationID, identity string, type trackingType, usage *Resource) bool</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that the above change includes the change described earlier which was made to support the automatic creation of the queue objects as part of the increaseResource call.</p>
<h3 class="anchor anchorWithStickyNavbar_NlAN" id="hierarchy-traversal">Hierarchy traversal<a href="#hierarchy-traversal" class="hash-link" aria-label="Direct link to Hierarchy traversal" title="Direct link to Hierarchy traversal">​</a></h3>
<p>The implementation of the hierarchical check should follow the same pattern as we currently do for the queues.
There is one major difference between the queue checks and the user and group checks.
For the queues we do not attempt to allocate unless there is unused quota available.
This starts at the top of the hierarchy and prevents recursing into the depth of the hierarchy towards the leaf queue.</p>
<p>For the users and groups we have already ended up as the leaf of the structure.
Checks will thus start at the leaf and work their way up to the root of the structure.
A check will be performed while traversing up the hierarchy. The traversal up the tree will stop if the check fails.
The change is applied when unwinding the traversal. This will guarantee a change is only committed when the whole hierarchy can be updated.</p>
<p><img decoding="async" loading="lazy" alt="queue hierarchy traversal" src="/assets/images/quota_check-87e525ada4251569f25f139c9879bf05.png" width="796" height="1255" class="img_qdMO"></p>
<p>Diagram of the quota check traversal related to the queue hierarchy.</p>
<h2 class="anchor anchorWithStickyNavbar_NlAN" id="exposure-of-quota-details">Exposure of quota details<a href="#exposure-of-quota-details" class="hash-link" aria-label="Direct link to Exposure of quota details" title="Direct link to Exposure of quota details">​</a></h2>
<p>The usage tracking information that is part of the user group manager is exposed for external consumption via REST.
The quotas set as part of the queue objects should be exposed in the REST output.
Exposing the quota independent of the usage makes interpretation difficult.</p>
<p>The quota set in the queueTracker at the specific entry is the quota that is enforced on that entry.
From a troubleshooting perspective this would be a requirement to allow an administrator to assess state.</p>
<p>Based on the current REST api definition the data exposed in the following two endpoints will be updated to expose the limits:<br>
<em>/ws/v1/partition/{partitionName}/usage/users</em><br>
<em>/ws/v1/partition/{partitionName}/usage/groups</em></p>
<p>For both endpoints we expose the full queue hierarchy. As an example below the approximate output for the users endpoint for one user:</p>
<div class="language-json codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-json codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;userName&quot;: &quot;user1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;groups&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;app1&quot;: &quot;tester&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;queues&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;queuename&quot;: &quot;root&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;resourceUsage&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;memory&quot;: 12000000000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;vcore&quot;: 12000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;runningApplications&quot;: [&quot;app1&quot;, &quot;app2&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;children&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;queuename&quot;: &quot;root.default&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;resourceUsage&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;memory&quot;: 6000000000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;vcore&quot;: 6000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;runningApplications&quot;: [&quot;app1&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;children&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;maxApplications&quot;: 10,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;maxResources&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;memory&quot;: 50000000000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;vcore&quot;: 100000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;queuename&quot;: &quot;root.test&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;resourceUsage&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;memory&quot;: 6000000000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;vcore&quot;: 6000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;runningApplications&quot;: [&quot;app2&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;children&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;maxApplications&quot;: 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;maxResources&quot;: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;maxApplications&quot;: 10,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;maxResources&quot;: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An example below the approximate output for the groups endpoint for one group:</p>
<div class="language-json codeBlockContainer_l7z8 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_N19i"><pre tabindex="0" class="prism-code language-json codeBlock_adB6 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_fSw7"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;groupName&quot; : &quot;tester&quot;, </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;users&quot;: [&quot;user1&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;queues&quot;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;queuename&quot;: &quot;root&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;resourceUsage&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;memory&quot;: 6000000000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;vcore&quot;: 6000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;runningApplications&quot;: [&quot;app2&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;children&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;queuename&quot;: &quot;root.test&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;resourceUsage&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;memory&quot;: 6000000000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;vcore&quot;: 6000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;runningApplications&quot;: [&quot;app2&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;children&quot;: [],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;maxApplications&quot;: 2,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;maxResources&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;vcore&quot;: 10000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;maxApplications&quot;: 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;maxResources&quot;: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup_ZiWg"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Gl1a" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mJ2i"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_rLlY"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/next/design/user_based_resource_usage_tracking"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">User Based Resource Usage Tracking</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/next/design/historical_usage_tracking"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Historical Usage Tracking</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_odww thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#goals" class="table-of-contents__link toc-highlight">Goals</a></li><li><a href="#non-goals" class="table-of-contents__link toc-highlight">Non Goals</a></li><li><a href="#configuration-processing" class="table-of-contents__link toc-highlight">Configuration processing</a><ul><li><a href="#generic-behaviour" class="table-of-contents__link toc-highlight">Generic behaviour</a></li><li><a href="#wildcard-interpretation" class="table-of-contents__link toc-highlight">Wildcard interpretation</a></li><li><a href="#example-configuration" class="table-of-contents__link toc-highlight">Example configuration</a></li><li><a href="#syntax-checking" class="table-of-contents__link toc-highlight">Syntax checking</a></li><li><a href="#quota-checks" class="table-of-contents__link toc-highlight">Quota checks</a></li></ul></li><li><a href="#configuration-updates-and-storage" class="table-of-contents__link toc-highlight">Configuration updates and storage</a><ul><li><a href="#processing-changes-existing-objects" class="table-of-contents__link toc-highlight">Processing changes existing objects</a></li><li><a href="#queue-tracking" class="table-of-contents__link toc-highlight">Queue tracking</a></li><li><a href="#user-tracking" class="table-of-contents__link toc-highlight">User tracking</a></li><li><a href="#group-tracking" class="table-of-contents__link toc-highlight">Group tracking</a></li></ul></li><li><a href="#new-queue-to-track" class="table-of-contents__link toc-highlight">New queue to track</a></li><li><a href="#enforcement-changes" class="table-of-contents__link toc-highlight">Enforcement changes</a><ul><li><a href="#tracker-interface-update" class="table-of-contents__link toc-highlight">Tracker interface update</a></li><li><a href="#user-tracking-1" class="table-of-contents__link toc-highlight">User tracking</a></li><li><a href="#group-tracking-1" class="table-of-contents__link toc-highlight">Group tracking</a></li><li><a href="#queue-tracking-1" class="table-of-contents__link toc-highlight">Queue tracking</a></li><li><a href="#hierarchy-traversal" class="table-of-contents__link toc-highlight">Hierarchy traversal</a></li></ul></li><li><a href="#exposure-of-quota-details" class="table-of-contents__link toc-highlight">Exposure of quota details</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cloudera.com/yunikorn-a-universal-resources-scheduler/" target="_blank" rel="noopener noreferrer" class="footer__link-item">What&#x27;s YuniKorn?<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.cloudera.com/spark-on-kubernetes-gang-scheduling-with-yunikorn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Spark on Kubernetes – Gang Scheduling with YuniKorn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Code Repositories</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/yunikorn-core/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Core scheduler<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-k8shim" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kubernetes shim<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-scheduler-interface" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scheduler Interface<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-web" target="_blank" rel="noopener noreferrer" class="footer__link-item">WEB application<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-site" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community/get_involved">Get Involved</a></li><li class="footer__item"><a class="footer__link-item" href="/community/people">People</a></li><li class="footer__item"><a href="https://issues.apache.org/jira/projects/YUNIKORN/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_n0Rw"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
<div style="font-size: 70%">
Copyright © 2020-2024 <a href="https://www.apache.org/">The Apache Software Foundation</a>. Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>. <br>
<div style="padding:20px; margin: 10px; color: #4d4d4d;">
<p>The Apache Software Foundation Apache YuniKorn, YuniKorn, Apache, the Apache feather, and the Apache YuniKorn project logo are either registered trademarks or trademarks of the Apache Software Foundation.</p>
</div>
</div></div></div></div></footer></div>
</body>
</html>