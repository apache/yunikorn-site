<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-user_guide/preemption_cases" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Preemption | Apache YuniKorn</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://yunikorn.apache.org/img/logo/yunikorn-logo-main.png"><meta data-rh="true" name="twitter:image" content="https://yunikorn.apache.org/img/logo/yunikorn-logo-main.png"><meta data-rh="true" property="og:url" content="https://yunikorn.apache.org/docs/next/user_guide/preemption_cases"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Preemption | Apache YuniKorn"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/img/yunikorn.ico"><link data-rh="true" rel="canonical" href="https://yunikorn.apache.org/docs/next/user_guide/preemption_cases"><link data-rh="true" rel="alternate" href="https://yunikorn.apache.org/docs/next/user_guide/preemption_cases" hreflang="en"><link data-rh="true" rel="alternate" href="https://yunikorn.apache.org/docs/next/user_guide/preemption_cases" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Preemption","item":"https://yunikorn.apache.org/docs/next/user_guide/preemption_cases"}]}</script><link rel="stylesheet" href="/assets/css/styles.217f981c.css">
<script src="/assets/js/runtime~main.cfc9e6cc.js" defer="defer"></script>
<script src="/assets/js/main.5a675ea8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo/yunikorn_blue_logo.png"><link rel="preload" as="image" href="/img/logo/yunikorn_white_logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G0hg" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_nM2J" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_cHVk"></div><div class="content_aNaP announcementBarContent_Euip">1.7.0 has been released, check the <a href="/community/download">DOWNLOADS</a>.</div><button type="button" aria-label="Close" class="clean-btn close closeButton_bCLl announcementBarClose__S2T"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo/yunikorn_blue_logo.png" alt="YuniKorn Site Logo" class="themedComponent_HM81 themedComponent--light_4L12"><img src="/img/logo/yunikorn_white_logo.png" alt="YuniKorn Site Logo" class="themedComponent_HM81 themedComponent--dark_ynFy"></div><b class="navbar__title text--truncate">Apache YuniKorn</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/community/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/community/download">Download</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/get_involved">Get Involved</a></li><li><a class="dropdown__link" href="/community/how_to_contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/community/coding_guidelines">Coding Guidelines</a></li><li><a class="dropdown__link" href="/community/reporting_issues">Reporting Issues</a></li><li><a class="dropdown__link" href="/community/release_procedure">Release Procedure</a></li><li><a class="dropdown__link" href="/community/events">Events</a></li><li><a class="dropdown__link" href="/community/people">People</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Apache Software Foundation<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsors<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy Policy<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/next/user_guide/preemption_cases">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/user_guide/preemption_cases">Next</a></li><li><a class="dropdown__link" href="/docs/user_guide/preemption_cases">1.7.0</a></li><li><a class="dropdown__link" href="/docs/1.6.3/user_guide/preemption_cases">1.6.3</a></li><li><a class="dropdown__link" href="/docs/1.6.2/user_guide/preemption_cases">1.6.2</a></li><li><a class="dropdown__link" href="/docs/1.6.1/user_guide/preemption_cases">1.6.1</a></li><li><a class="dropdown__link" href="/docs/1.6.0/user_guide/preemption_cases">1.6.0</a></li><li><a class="dropdown__link" href="/docs/1.5.2/user_guide/preemption_cases">1.5.2</a></li><li><a class="dropdown__link" href="/docs/1.5.1/user_guide/preemption_cases">1.5.1</a></li><li><a class="dropdown__link" href="/docs/1.5.0/user_guide/preemption_cases">1.5.0</a></li><li><a class="dropdown__link" href="/docs/1.4.0/user_guide/preemption_cases">1.4.0</a></li><li><a class="dropdown__link" href="/docs/1.3.0/">1.3.0</a></li><li><a class="dropdown__link" href="/docs/1.2.0/">1.2.0</a></li><li><a class="dropdown__link" href="/docs/1.1.0/">1.1.0</a></li><li><a class="dropdown__link" href="/docs/1.0.0/">1.0.0</a></li></ul></div><a href="https://github.com/apache/yunikorn-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_cqzx colorModeToggle_FkZK"><button class="clean-btn toggleButton_nGd9 toggleButtonDisabled_YJ4Z" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_gDVs lightToggleIcon_R738"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_gDVs darkToggleIcon_jyO8"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_gDVs systemToggleIcon_Z_SS"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Chmn"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_QlCJ"><div class="docsWrapper_ZuNT"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_X6K6" type="button"></button><div class="docRoot_vTLD"><aside class="theme-doc-sidebar-container docSidebarContainer_pcDe"><div class="sidebarViewport_dHnN"><div class="sidebar_mO87"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_U5hm menuWithAnnouncementBar_C2ZB"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_HLbS menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/next/"><span title="Get Started" class="categoryLinkLabel_kdvp">Get Started</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_HLbS menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/next/user_guide/deployment_modes"><span title="User Guide" class="categoryLinkLabel_kdvp">User Guide</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/deployment_modes"><span title="Deployment Modes" class="linkLabel_JXWF">Deployment Modes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/service_config"><span title="Service Configuration" class="linkLabel_JXWF">Service Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/queue_config"><span title="Partition and Queue Configuration" class="linkLabel_JXWF">Partition and Queue Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/placement_rules"><span title="App Placement Rules" class="linkLabel_JXWF">App Placement Rules</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/usergroup_resolution"><span title="User &amp; Group Resolution" class="linkLabel_JXWF">User &amp; Group Resolution</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/sorting_policies"><span title="Sorting Policies" class="linkLabel_JXWF">Sorting Policies</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/priorities"><span title="App &amp; Queue Priorities" class="linkLabel_JXWF">App &amp; Queue Priorities</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/next/user_guide/preemption_cases"><span title="Preemption" class="linkLabel_JXWF">Preemption</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/acls"><span title="ACLs" class="linkLabel_JXWF">ACLs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/resource_quota_management"><span title="Resource Quota Management" class="linkLabel_JXWF">Resource Quota Management</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/gang_scheduling"><span title="Gang Scheduling" class="linkLabel_JXWF">Gang Scheduling</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/labels_and_annotations_in_yunikorn"><span title="Labels and Annotations in YuniKorn" class="linkLabel_JXWF">Labels and Annotations in YuniKorn</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/use_cases"><span title="Use Cases" class="linkLabel_JXWF">Use Cases</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/event_system"><span title="Event System" class="linkLabel_JXWF">Event System</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_HLbS menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/next/user_guide/workloads/workload_overview"><span title="Workloads" class="categoryLinkLabel_kdvp">Workloads</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_HLbS menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/next/user_guide/observability/prometheus"><span title="Observability" class="categoryLinkLabel_kdvp">Observability</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_HLbS menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/next/api/cluster"><span title="REST APIs" class="categoryLinkLabel_kdvp">REST APIs</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/troubleshooting"><span title="Troubleshooting" class="linkLabel_JXWF">Troubleshooting</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_HLbS menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/next/developer_guide/env_setup"><span title="Developer Guide" class="categoryLinkLabel_kdvp">Developer Guide</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_HLbS menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/next/performance/evaluate_perf_function_with_kubemark"><span title="Performance" class="categoryLinkLabel_kdvp">Performance</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_esjk"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_yMZL"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Apache YuniKorn<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/user_guide/preemption_cases">latest version</a></b> (<!-- -->1.7.0<!-- -->).</div></div><div class="docItemContainer_Go7X"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_R27A" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_SIVF"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">User Guide</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Preemption</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_VaoB theme-doc-toc-mobile tocMobile_Ukrl"><button type="button" class="clean-btn tocCollapsibleButton_Tyoc">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Preemption</h1></header><p>Preemption is an essential feature found in most schedulers, and it plays a crucial role in enabling key system functionalities like DaemonSets in K8s, as well as SLA and prioritization-based features.</p>
<p>This document provides a brief introduction to the concepts and configuration methods of preemption in YuniKorn. For a more comprehensive understanding of YuniKorn&#x27;s design and practical ideas related to preemption, please refer to the <a class="" href="/docs/next/design/preemption">design document</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_AWn9" id="kubernetes-preemption">Kubernetes Preemption<a href="#kubernetes-preemption" class="hash-link" aria-label="Direct link to Kubernetes Preemption" title="Direct link to Kubernetes Preemption" translate="no">​</a></h2>
<p>Preemption in Kubernetes operates based on priorities. Starting from Kubernetes 1.14, you can configure preemption by adding a <code>preemptionPolicy</code> to the <code>PriorityClass</code>. However, it is important to note that preemption in Kubernetes is solely based on the priority of the pod during scheduling. The full documentation can be found <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/#preemption" target="_blank" rel="noopener noreferrer" class="">here</a>.</p>
<p>While Kubernetes does support preemption, it does have some limitations. Preemption in Kubernetes only occurs during the scheduling cycle and does not change once the scheduling is complete. However, when considering batch or data processing workloads, it becomes necessary to account for the possibility of opting out at runtime.</p>
<h2 class="anchor anchorTargetStickyNavbar_AWn9" id="yunikorn-preemption">YuniKorn Preemption<a href="#yunikorn-preemption" class="hash-link" aria-label="Direct link to YuniKorn Preemption" title="Direct link to YuniKorn Preemption" translate="no">​</a></h2>
<p>In Yunikorn, we offer two preemption types: general and DaemonSet. DaemonSet preemption is much more straightforward, as it ensures that pods which must run on a particular node are allowed to do so. The rest of the documentation only concerns generic preemption. For a comprehensive explanation of DaemonSet preemption, please consult the <a class="" href="/docs/next/design/simple_preemptor">design document</a>.</p>
<p>YuniKorn&#x27;s generic preemption is based on a hierarchical queue model, enabling pods to opt out of running. Preemption is triggered after a specified delay, ensuring that each queue&#x27;s resource usage reaches at least the guaranteed amount of resources. To configure the delay time for preemption triggering, you can utilize the <code>preemption.delay</code> property in the configuration.</p>
<p>To prevent the occurrence of preemption storms or loops, where subsequent preemption tasks trigger additional preemption tasks, we have designed seven preemption laws. These laws are as follows:</p>
<ol>
<li class="">Preemption policies are strong suggestions, not guarantees</li>
<li class="">Preemption can never leave a queue lower than its guaranteed capacity</li>
<li class="">A task cannot preempt other tasks in the same application</li>
<li class="">A task cannot trigger preemption unless its queue is under its guaranteed capacity</li>
<li class="">A task cannot be preempted unless its queue is over its guaranteed capacity</li>
<li class="">A task can only preempt a task with lower or equal priority</li>
<li class="">A task cannot preempt tasks outside its preemption fence</li>
</ol>
<p>For a detailed explanation of these preemption laws, please refer to the preemption <a class="" href="/docs/next/design/preemption#the-laws-of-preemption">design document</a>.</p>
<p>Next, we will provide a few examples to help you understand the functionality and impact of preemption, allowing you to deploy it effectively in your environment. You can find the necessary files for the examples in the yunikorn-k8shim/deployments/examples/preemption directory.</p>
<p>Included in the files is a YuniKorn configuration that defines the queue configuration as follows:</p>
<div class="language-bash codeBlockContainer_PN8f theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_k8So"><pre tabindex="0" class="prism-code language-bash codeBlock_zcHk thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_YoHr"><span class="token-line" style="color:#bfc7d5"><span class="token plain">queues.yaml: |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    partitions: </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    - name: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      placementrules:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        - name: provided</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          create: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      queues:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        - name: root</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          submitacl: &#x27;*&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          properties:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            preemption.policy: fence</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            preemption.delay: 10s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          queues:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - name: 1-normal ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - name: 2-no-guaranteed ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - name: 3-priority-class ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - name: 4-priority-queue ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - name: 5-fence ...</span><br></span></code></pre></div></div>
<p>Each queue corresponds to a different example, and the preemption will be triggered 10 seconds after deployment, as indicated in the configuration <code>preemption.delay: 10s</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_AWn9" id="general-preemption-case">General Preemption Case<a href="#general-preemption-case" class="hash-link" aria-label="Direct link to General Preemption Case" title="Direct link to General Preemption Case" translate="no">​</a></h3>
<p>In this case, we will demonstrate the outcome of triggering preemption when the queue resources are distributed unevenly in a general scenario.</p>
<p>We will deploy 10 pods with a resource requirement of 1 to both <code>queue-1</code> and <code>queue-2</code>. First, we deploy to <code>queue-1</code> and then introduce a few seconds delay before deploying to <code>queue-2</code>. This ensures that the resource usage in <code>queue-1</code> will exceed that of <code>queue-2</code>, depleting all resources in the parent queue and triggering preemption.</p>
<table><thead><tr><th>Queue</th><th>Max Resource</th><th>Guaranteed Resource</th></tr></thead><tbody><tr><td><code>normal</code></td><td>12</td><td>- (not configured)</td></tr><tr><td><code>normal.queue-1</code></td><td>10</td><td>5</td></tr><tr><td><code>normal.queue-2</code></td><td>10</td><td>5</td></tr></tbody></table>
<p>Result:</p>
<p>When a set of guaranteed resources is defined, preemption aims to ensure that all queues satisfy their guaranteed resources. Preemption stops once the guaranteed resources are met (law 4). A queue may be preempted if it has more resources than its guaranteed amount. For instance, in this case, if queue-1 has fewer resources than its guaranteed amount (&lt;5), it will not be preempted (law 5).</p>
<table><thead><tr><th>Queue</th><th>Resource before preemption</th><th>Resource after preemption</th></tr></thead><tbody><tr><td><code>normal.queue-1</code></td><td>10 (victim)</td><td>7</td></tr><tr><td><code>normal.queue-2</code></td><td>2</td><td>5 (guaranteed minimum)</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" alt="preemption_normal_case" src="/assets/images/preemption_normal_case-ba5958d682dd2e94e9cd3afd272e840e.png" width="668" height="624" class="img_Juj7"></p>
<h3 class="anchor anchorTargetStickyNavbar_AWn9" id="priority">Priority<a href="#priority" class="hash-link" aria-label="Direct link to Priority" title="Direct link to Priority" translate="no">​</a></h3>
<p>In general, a pod can preempt a pod with equal or lower priority. You can set the priority by defining a <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/" target="_blank" rel="noopener noreferrer" class="">PriorityClass</a> or by utilizing <a class="" href="/docs/next/user_guide/priorities">queue priorities</a>.</p>
<p>While preemption allows service-type pods to scale up or down through preemption, it can also lead to the preemption of pods that should not be preempted in certain scenarios:</p>
<ol>
<li class="">Spark Jobs, where the driver pod manages a large number of jobs, and if preempted, all jobs will be affected.</li>
<li class="">Interactive pods, such as Python notebooks, have a significant impact when restarted and should be avoided from preemption.</li>
</ol>
<p>To address this issue, we have designed a &quot;do not preempt me&quot; flag. You can set the annotation <code>yunikorn.apache.org/allow-preemption</code> to <code>false</code> in the PriorityClass to prevent pod requests from being preempted.</p>
<blockquote>
<p><strong><em>NOTE:</em></strong> The flag <code>yunikorn.apache.org/allow-preemption</code> is a request only. It is not guaranteed but Pods annotated with this flag will be preempted last.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_AWn9" id="priorityclass">PriorityClass<a href="#priorityclass" class="hash-link" aria-label="Direct link to PriorityClass" title="Direct link to PriorityClass" translate="no">​</a></h3>
<p>In this example, we will demonstrate the configuration of <code>yunikorn.apache.org/allow-preemption</code> using PriorityClass and observe its effect. The default value for this configuration is set to <code>true</code>.</p>
<div class="language-bash codeBlockContainer_PN8f theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_k8So"><pre tabindex="0" class="prism-code language-bash codeBlock_zcHk thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_YoHr"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: scheduling.k8s.io/v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kind: PriorityClass</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: preemption-not-allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  annotations:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;yunikorn.apache.org/allow-preemption&quot;: &quot;false&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">value: 0</span><br></span></code></pre></div></div>
<p>We will deploy 8 pods with a resource requirement of 1 to <code>queue-1</code>, <code>queue-2</code>, and <code>queue-3</code>, respectively. We will deploy to <code>queue-1</code> and <code>queue-2</code> first, followed by a few seconds delay before deploying to <code>queue-3</code>. This ensures that the resource usage in <code>queue-1</code> and <code>queue-2</code> will be greater than that in <code>queue-3</code>, depleting all resources in the parent queue and triggering preemption.</p>
<table><thead><tr><th>Queue</th><th>Max Resource</th><th>Guaranteed Resource</th><th><code>allow-preemption</code></th></tr></thead><tbody><tr><td><code>rt</code></td><td>16</td><td>-</td><td></td></tr><tr><td><code>rt.queue-1</code></td><td>8</td><td>3</td><td><code>true</code></td></tr><tr><td><code>rt.queue-2</code></td><td>8</td><td>3</td><td><code>false</code></td></tr><tr><td><code>rt.queue-3</code></td><td>8</td><td>3</td><td><code>true</code></td></tr></tbody></table>
<p>Result:</p>
<p>When preemption is triggered, <code>queue-3</code> will start searching for a victim. However, since <code>queue-2</code> is set with allow-preemption as false, the resources of <code>queue-1</code> will be preempted.</p>
<p>Please note that setting <code>yunikorn.apache.org/allow-preemption</code> is a strong recommendation but does not guarantee the lack of preemption. When this flag is set to <code>false</code>, it moves the Pod to the back of the preemption list, giving it a lower priority for preemption compared to other Pods. However, in certain scenarios, such as when no other preemption options are available, Pods with this flag may still be preempted.</p>
<p>For example, even with <code>allow-preemption</code> set to <code>false</code>, DaemonSet pods can still trigger preemption. Additionally, if an application in <code>queue-1</code> has a higher priority than one in <code>queue-3</code>, the application in <code>queue-2</code> will be preempted because an application can never preempt another application with a higher priority. In such cases where no other preemption options exist, the <code>allow-preemption</code> flag may not prevent preemption.</p>
<table><thead><tr><th>Queue</th><th>Resource before preemption</th><th>Resource after preemption</th></tr></thead><tbody><tr><td><code>rt.queue-1</code></td><td>8 (victim)</td><td>5</td></tr><tr><td><code>rt.queue-2</code></td><td>8</td><td>8</td></tr><tr><td><code>rt.queue-3</code></td><td>0</td><td>3 (guaranteed minimum)</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" alt="preemption_priorityclass_case" src="/assets/images/preemption_priorityclass_case-a02a8b5b00a77ba6861bdf7f2839563c.png" width="722" height="763" class="img_Juj7"></p>
<h3 class="anchor anchorTargetStickyNavbar_AWn9" id="priority-queue">Priority Queue<a href="#priority-queue" class="hash-link" aria-label="Direct link to Priority Queue" title="Direct link to Priority Queue" translate="no">​</a></h3>
<p>In addition to utilizing the default PriorityClass in Kubernetes, you can configure priorities directly on a <a class="" href="/docs/next/user_guide/priorities">YuniKorn queue</a>.</p>
<p>In the following example, we will demonstrate preemption based on queue priority.</p>
<p>We will deploy five pods with a resource demand of 3 in the <code>high-pri</code> queue, <code>norm-pri</code> queue, and <code>low-pri</code> queue, respectively. We will deploy them to the <code>norm-pri</code> queue first, ensuring that the resources in the <code>root</code>(parent queue) will be fully utilized. This will result in uneven resource distribution among the queues, triggering preemption.</p>
<table><thead><tr><th>Queue</th><th>Max Resource</th><th>Guaranteed Resource</th><th>priority.offset</th></tr></thead><tbody><tr><td><code>root</code></td><td>18</td><td>-</td><td></td></tr><tr><td><code>root.high-pri</code></td><td>10</td><td>6</td><td>100</td></tr><tr><td><code>root.norm-pri</code></td><td>18</td><td>6</td><td>0</td></tr><tr><td><code>root.low-pri</code></td><td>10</td><td>6</td><td>-100</td></tr></tbody></table>
<p>Result:</p>
<p>A queue with higher priority can preempt resources from a queue with lower priority, and preemption stops when the queue has preempted enough resources to satisfy its guaranteed resources.</p>
<table><thead><tr><th>Queue</th><th>Resource before preemption</th><th>Resource after preemption</th></tr></thead><tbody><tr><td><code>root.high-pri</code></td><td>0</td><td>6 (guaranteed minimum)</td></tr><tr><td><code>root.norm-pri</code></td><td>18 (victim)</td><td>12</td></tr><tr><td><code>root.low-pri</code></td><td>0</td><td>0</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" alt="preemption_priority_queue_case" src="/assets/images/preemption_priority_queue_case-3353239aaaa37023bb69ecc662f954a8.png" width="646" height="762" class="img_Juj7"></p>
<h3 class="anchor anchorTargetStickyNavbar_AWn9" id="preemption-fence">Preemption Fence<a href="#preemption-fence" class="hash-link" aria-label="Direct link to Preemption Fence" title="Direct link to Preemption Fence" translate="no">​</a></h3>
<p>In a multi-tenant environment, it is essential to prevent one tenant from occupying the resources of another tenant. In YuniKorn, we map tenants to a queue hierarchy, the queue hierarchy can thus cross tenant boundaries.</p>
<p>To address this issue, YuniKorn introduces a <a class="" href="/docs/next/design/preemption#preemption-fence">preemption fence</a>, which is a setting on the queue that prevents preemption from looking at queues outside the fence boundary.  The fence is a one-way fence. It prevents going out (i.e. higher up the queue hierarchy), but does not prevent coming in (or down) the queue hierarchy.</p>
<div class="language-bash codeBlockContainer_PN8f theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_k8So"><pre tabindex="0" class="prism-code language-bash codeBlock_zcHk thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_YoHr"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">queues:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- name: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  properties:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    preemption.policy: fence</span><br></span></code></pre></div></div>
<p>We will use the following diagram as an example:</p>
<p><img decoding="async" loading="lazy" alt="preemption_fence_hierarchy_case" src="/assets/images/preemption_fence_hierarchy_case-1575612a5cd83829e9361f4eab0afd9c.png" width="1579" height="633" class="img_Juj7"></p>
<p>In this example, we will sequentially deploy 15 pods with a resource requirement of 1 to each sub-queue.</p>
<p>First, we deploy <code>queue-1</code> in <code>tenant-a</code> and wait until the application in <code>queue-1</code> occupies all the resources of <code>tenant-a</code>. Then, we deploy <code>queue-2</code> after the resources of <code>tenant-a</code> are fully utilized. Next, we deploy the application <code>ten-b.queue-3</code> and allocate resources to the system when the fence queue is full.</p>
<table><thead><tr><th>Queue</th><th>Max Resource</th><th>Guaranteed Resource</th><th>fence</th></tr></thead><tbody><tr><td><code>rt</code></td><td>3</td><td>-</td><td>true</td></tr><tr><td><code>rt.ten-a</code></td><td>15</td><td>5</td><td>true</td></tr><tr><td><code>rt.ten-a.queue-1</code></td><td>15</td><td>2</td><td></td></tr><tr><td><code>rt.ten-a.queue-2</code></td><td>15</td><td>2</td><td>true</td></tr><tr><td><code>rt.ten-b</code></td><td>15</td><td>10</td><td>true</td></tr><tr><td><code>rt.ten-b.queue-3</code></td><td>15</td><td>10</td><td></td></tr><tr><td><code>rt.sys</code></td><td>15</td><td>10</td><td></td></tr></tbody></table>
<p>Result:</p>
<p>In this example, two imbalances are observed:</p>
<ul>
<li class="">Within <code>ten-a</code>, <code>queue-1</code> occupies all the resources, while <code>queue-2</code> has no resources. However, since <code>queue-2</code> is configured with a fence, it cannot acquire resources from outside the fence.
<img decoding="async" loading="lazy" alt="preemption_fence_case1" src="/assets/images/preemption_fence_case1-774a3f77aa98fdf9084e314e40e13e56.png" width="809" height="332" class="img_Juj7"></li>
<li class="">Inside the <code>rt</code> queue, both <code>ten-a</code> and <code>ten-b</code> occupy all the resources, while the <code>sys</code> queue has no resources, and no fence is set up. Therefore, the <code>sys</code> queue can acquire resources from the queues in the hierarchy until its guaranteed resources are met. In this case, the <code>sys</code> queue acquires resources from both <code>ten-a</code> and <code>ten-b</code>.
<img decoding="async" loading="lazy" alt="preemption_fence_case2" src="/assets/images/preemption_fence_case2-5b1821999da91de2c6e3aab3e31026d4.png" width="548" height="886" class="img_Juj7"></li>
</ul>
<table><thead><tr><th>Queue</th><th>Resource before preemption</th><th>Resource after preemption</th></tr></thead><tbody><tr><td><code>rt.ten-a</code></td><td>15</td><td>10</td></tr><tr><td><code>rt.ten-a.queue-1</code></td><td>15</td><td>10</td></tr><tr><td><code>rt.ten-a.queue-2</code></td><td>0</td><td>0</td></tr><tr><td><code>rt.ten-b</code></td><td>15</td><td>10</td></tr><tr><td><code>rt.ten-b.queue-3</code></td><td>15</td><td>10</td></tr><tr><td><code>rt.sys</code></td><td>0</td><td>10</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_AWn9" id="redistribution-of-quota-and-preemption-storm">Redistribution of Quota and Preemption Storm<a href="#redistribution-of-quota-and-preemption-storm" class="hash-link" aria-label="Direct link to Redistribution of Quota and Preemption Storm" title="Direct link to Redistribution of Quota and Preemption Storm" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_AWn9" id="redistribution-of-quota">Redistribution of Quota<a href="#redistribution-of-quota" class="hash-link" aria-label="Direct link to Redistribution of Quota" title="Direct link to Redistribution of Quota" translate="no">​</a></h4>
<p>Setting up guaranteed resources for the queue present at a higher level in the queue hierarchy helps to re-distribute the quota among different groups. Especially when workloads of the same priority run in different groups, unlike the default scheduler, YuniKorn preempts workloads of the same priority to free up resources for pending workloads who deserve to get the resources as per the queues guaranteed quota. At times, one needs this kind of queue setup in a real production cluster for redistribution.</p>
<p>For example, root.region[1-N].country[1-N].state[1-N]</p>
<p><img decoding="async" loading="lazy" alt="preemption_quota_redistribution" src="/assets/images/preemption_quota_redistribution-7f5b9a4d6010b238c090e0388ce5e206.png" width="2753" height="1452" class="img_Juj7"></p>
<p>This queue setup has N regions under “root”, each region has N countries. If administrators want to redistribute the workloads of the same priority among different regions, then it is better to define the guaranteed quota for each region so that preemption helps to reach the situation of running the workloads by redistribution based on the guaranteed quota each region is supposed to get. That way each region uses the resources it deserves to get at the maximum possible level from the overall cluster resources.</p>
<h4 class="anchor anchorTargetStickyNavbar_AWn9" id="preemption-storm">Preemption Storm<a href="#preemption-storm" class="hash-link" aria-label="Direct link to Preemption Storm" title="Direct link to Preemption Storm" translate="no">​</a></h4>
<p>With a setup like above, there is a side effect of increasing the chance of a preemption storm or loop happening within the specific region between different state queues (siblings belonging to same parent).</p>
<p>ReplicaSets are a good example to look at for looping and circular preemption. Each time a pod from a replica set is removed the ReplicaSet controller will create a new pod to make sure the set is complete. That auto-recreation could trigger loops as described below.</p>
<p><img decoding="async" loading="lazy" alt="preemption_storm" src="/assets/images/preemption_storm-5b072060a65e49b58cd6f0a6dca3c703.png" width="2346" height="1704" class="img_Juj7"></p>
<p>State of the queues:</p>
<h4 class="anchor anchorTargetStickyNavbar_AWn9" id="region1"><code>Region1</code><a href="#region1" class="hash-link" aria-label="Direct link to region1" title="Direct link to region1" translate="no">​</a></h4>
<ul>
<li class="">Guaranteed: vcores = 10</li>
<li class="">Usage: vcores = 8</li>
<li class="">Under guaranteed: usage &lt; guaranteed, starving</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_AWn9" id="state1"><code>State1</code><a href="#state1" class="hash-link" aria-label="Direct link to state1" title="Direct link to state1" translate="no">​</a></h4>
<ul>
<li class="">Guaranteed: nil</li>
<li class="">A ReplicaSet is submitted to queue and requesting 9 replicas, with each replica requiring <code>{vcores: 1}</code>.</li>
<li class="">4 replicas are running. Usage: vcores = 4</li>
<li class="">5 replicas are waiting for resources. Pending: vcores = 5</li>
<li class="">Inherits &quot;under guaranteed&quot; behaviour from <code>Region1</code>, eligible to trigger preemption</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_AWn9" id="state2"><code>State2</code><a href="#state2" class="hash-link" aria-label="Direct link to state2" title="Direct link to state2" translate="no">​</a></h4>
<ul>
<li class="">Guaranteed: nil</li>
<li class="">A ReplicaSet is submitted to queue and requesting 9 replicas, with each replica requiring <code>{vcores: 1}</code>.</li>
<li class="">4 replicas are running. Usage: vcores = 4</li>
<li class="">5 replicas are waiting for resources. Pending: vcores = 5</li>
<li class="">Inherits &quot;under guaranteed&quot; behaviour from <code>Region1</code>, eligible to trigger preemption</li>
</ul>
<p>Replica set <code>State1 Repl</code> runs in queue <code>State1</code>. Replica set <code>State2 Repl</code> runs in the queue <code>State2</code>. Both queues belong to the same parent queue (they are siblings), <code>Country1</code>. The pods all run with the same settings for priority and preemption. There is no space left on the cluster. Both region, <code>Region1</code> and country, <code>Country1</code> queue usage is <code>{vcores:8}</code>. Since <code>Region1</code> has a guaranteed quota of <code>{vcores:10}</code> and usage of <code>{vcores:8}</code> lower than its guaranteed quota leading to starvation of resources. All the queues (including both direct or indirect) below the parent queue are starving as it inherits the “under guaranteed” behavior from above said parent queue, <code>Region1</code> calculation unless each state (leaf) queue has its own guaranteed quota. Now, either one of these state queues can trigger preemption.</p>
<p>Let&#x27;s say, <code>state1</code> triggers preemption to meet resource requirements for pending pods.
To make room for a <code>State1 Repl</code> pod, a pod from the <code>State2 Repl</code> set is preempted. Now, the pending <code>State1 Repl</code> pod moves from pending to running. Now, the next scheduling cycle comes. Let&#x27;s say, <code>State2</code> triggers preemption to meet resource requirements for its pending pods. In addition to already existing pending pods, pod preempted (killed) in earlier scheduling cycles would have been recreated automatically by this time as it is a replica set. To make room for a <code>State2 Repl</code> pod, a pod from the <code>State1 Repl</code> set is preempted. Now, the pending <code>State2 Repl</code> pod moves from pending to running and preempted (killed) pod belonging to <code>State1 Repl</code> set would be recreated again. Now, the next scheduling cycle comes. Again, the whole loop repeats killing each other from the siblings without going anywhere leading to a preemption storm causing instability of the queues. It could even happen for a child queue below <code>Country2</code> that gets caught in the preemption storm.</p>
<p>Defining guaranteed resources at queues at lower level or at end leaf queues can avoid the preemption storm or loop from happening in the cluster. Administrators should be aware of the side effects of setting up guaranteed resources at any specific location in the queue hierarchy to reap the best possible outcomes of the preemption process.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/next/user_guide/priorities"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">App &amp; Queue Priorities</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/next/user_guide/acls"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ACLs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_QWoO thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#kubernetes-preemption" class="table-of-contents__link toc-highlight">Kubernetes Preemption</a></li><li><a href="#yunikorn-preemption" class="table-of-contents__link toc-highlight">YuniKorn Preemption</a><ul><li><a href="#general-preemption-case" class="table-of-contents__link toc-highlight">General Preemption Case</a></li><li><a href="#priority" class="table-of-contents__link toc-highlight">Priority</a></li><li><a href="#priorityclass" class="table-of-contents__link toc-highlight">PriorityClass</a></li><li><a href="#priority-queue" class="table-of-contents__link toc-highlight">Priority Queue</a></li><li><a href="#preemption-fence" class="table-of-contents__link toc-highlight">Preemption Fence</a></li><li><a href="#redistribution-of-quota-and-preemption-storm" class="table-of-contents__link toc-highlight">Redistribution of Quota and Preemption Storm</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cloudera.com/yunikorn-a-universal-resources-scheduler/" target="_blank" rel="noopener noreferrer" class="footer__link-item">What&#x27;s YuniKorn?<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://blog.cloudera.com/spark-on-kubernetes-gang-scheduling-with-yunikorn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Spark on Kubernetes – Gang Scheduling with YuniKorn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Code Repositories</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/yunikorn-core/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Core scheduler<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-k8shim" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kubernetes shim<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-scheduler-interface" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scheduler Interface<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-web" target="_blank" rel="noopener noreferrer" class="footer__link-item">WEB application<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-site" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community/get_involved">Get Involved</a></li><li class="footer__item"><a class="footer__link-item" href="/community/people">People</a></li><li class="footer__item"><a href="https://issues.apache.org/jira/projects/YUNIKORN/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_JuB_"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
<div style="font-size: 70%">
Copyright © 2020-2025 <a href="https://www.apache.org/">The Apache Software Foundation</a>. Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>. <br>
<div style="padding:20px; margin: 10px; color: #4d4d4d;">
<p>The Apache Software Foundation Apache YuniKorn, YuniKorn, Apache, the Apache feather, and the Apache YuniKorn project logo are either registered trademarks or trademarks of the Apache Software Foundation.</p>
</div>
</div></div></div></div></footer></div>
</body>
</html>